<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>RPG Mundo Aberto - Protótipo</title>
<style>
  body, html {
    margin:0; padding:0; height:100%; overflow:hidden; font-family: Arial, sans-serif;
    background: #222;
    color: white;
    user-select:none;
  }
  #gameCanvas {
    background: #3a5f0b; /* gramado */
    display: block;
    margin: auto;
    border: 3px solid #000;
  }
  #ui {
    position: absolute;
    top:10px; left:10px; right:10px;
    color:#fff;
    font-weight: bold;
    font-size: 18px;
    display: flex;
    justify-content: space-between;
    pointer-events: none;
  }
  #classSelect {
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    background: #222;
    border: 3px solid #4caf50;
    padding: 20px;
    border-radius: 10px;
    max-width: 320px;
    text-align: center;
    user-select:none;
  }
  #classSelect h2 {
    margin-bottom: 15px;
  }
  #classList button {
    display: block;
    width: 100%;
    margin: 5px 0;
    padding: 8px 12px;
    background: #4caf50;
    border: none;
    color: white;
    font-weight: bold;
    cursor: pointer;
    border-radius: 6px;
    transition: background 0.3s;
  }
  #classList button:hover {
    background: #357a38;
  }
</style>
</head>
<body>

<div id="classSelect">
  <h2>Escolha sua Classe</h2>
  <div id="classList"></div>
</div>

<canvas id="gameCanvas" width="640" height="400" style="display:none;"></canvas>

<div id="ui" style="display:none;">
  <div>Classe: <span id="className"></span></div>
  <div>XP: <span id="xp">0</span></div>
  <div>Nível: <span id="level">1</span></div>
</div>

<script>
  // Definindo as 20 classes básicas
  const classes = [
    {name:"Guerreiro", hp:100, atk:15, def:10, speed:3},
    {name:"Mago", hp:70, atk:25, def:5, speed:4},
    {name:"Arqueiro", hp:80, atk:18, def:8, speed:5},
    {name:"Ladino", hp:75, atk:20, def:6, speed:6},
    {name:"Paladino", hp:110, atk:12, def:15, speed:3},
    {name:"Bárbaro", hp:130, atk:20, def:7, speed:2},
    {name:"Druida", hp:85, atk:18, def:10, speed:4},
    {name:"Caçador", hp:90, atk:17, def:8, speed:5},
    {name:"Feiticeiro", hp:65, atk:30, def:4, speed:4},
    {name:"Monge", hp:80, atk:20, def:10, speed:7},
    {name:"Assassino", hp:70, atk:28, def:5, speed:8},
    {name:"Necromante", hp:60, atk:32, def:3, speed:4},
    {name:"Cavaleiro", hp:120, atk:14, def:15, speed:3},
    {name:"Arcanista", hp:75, atk:24, def:7, speed:4},
    {name:"Caótico", hp:85, atk:20, def:9, speed:5},
    {name:"Gladiador", hp:115, atk:18, def:12, speed:3},
    {name:"Mercenário", hp:100, atk:22, def:9, speed:4},
    {name:"Bardo", hp:70, atk:15, def:7, speed:5},
    {name:"Samurai", hp:105, atk:20, def:10, speed:5},
    {name:"Xamã", hp:80, atk:21, def:8, speed:4}
  ];

  const canvas = document.getElementById("gameCanvas");
  const ctx = canvas.getContext("2d");
  const ui = document.getElementById("ui");
  const classSelect = document.getElementById("classSelect");
  const classList = document.getElementById("classList");
  const classNameSpan = document.getElementById("className");
  const xpSpan = document.getElementById("xp");
  const levelSpan = document.getElementById("level");

  // Preencher seleção de classes
  classes.forEach((cl, idx) => {
    const btn = document.createElement("button");
    btn.textContent = cl.name;
    btn.onclick = () => startGame(idx);
    classList.appendChild(btn);
  });

  // Player e estado do jogo
  let player = null;
  let keys = {};
  let xp = 0;
  let level = 1;

  // Mapa simples: área verde com algumas árvores
  const map = {
    width: 2000,
    height: 1200,
    trees: []
  };

  // Criar árvores aleatórias
  for(let i=0; i<100; i++) {
    map.trees.push({
      x: Math.random()*map.width,
      y: Math.random()*map.height,
      size: 40 + Math.random()*20
    });
  }

  // Iniciar jogo após escolher classe
  function startGame(classIndex) {
    player = {...classes[classIndex]};
    player.x = map.width/2;
    player.y = map.height/2;

    xp = 0;
    level = 1;

    classSelect.style.display = "none";
    canvas.style.display = "block";
    ui.style.display = "flex";
    classNameSpan.textContent = player.name;
    xpSpan.textContent = xp;
    levelSpan.textContent = level;

    window.requestAnimationFrame(gameLoop);
  }

  window.addEventListener("keydown", (e) => { keys[e.key.toLowerCase()] = true; });
  window.addEventListener("keyup", (e) => { keys[e.key.toLowerCase()] = false; });

  // Atualiza jogador baseado em teclado
  function updatePlayer() {
    let speed = player.speed;
    if(keys["shift"]) speed *= 1.8; // correr

    if(keys["w"] || keys["arrowup"]) player.y -= speed;
    if(keys["s"] || keys["arrowdown"]) player.y += speed;
    if(keys["a"] || keys["arrowleft"]) player.x -= speed;
    if(keys["d"] || keys["arrowright"]) player.x += speed;

    // Limitar posição no mapa
    if(player.x < 0) player.x = 0;
    if(player.y < 0) player.y = 0;
    if(player.x > map.width) player.x = map.width;
    if(player.y > map.height) player.y = map.height;
  }

  // Função para desenhar mapa (grama + árvores)
  function drawMap() {
    // fundo grama
    ctx.fillStyle = "#3a5f0b";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // árvores simples (círculos verdes escuros)
    map.trees.forEach(tree => {
      let tx = tree.x - camera.x;
      let ty = tree.y - camera.y;
      if(tx + tree.size < 0 || ty + tree.size < 0 || tx - tree.size > canvas.width || ty - tree.size > canvas.height) return;
      ctx.fillStyle = "#145214";
      ctx.beginPath();
      ctx.ellipse(tx, ty, tree.size/2, tree.size, 0, 0, Math.PI*2);
      ctx.fill();
    });
  }

  // Player desenhado como um quadrado azul
  function drawPlayer() {
    let px = player.x - camera.x;
    let py = player.y - camera.y;

    ctx.fillStyle = "blue";
    ctx.fillRect(px - player.width/2, py - player.height/2, player.width, player.height);
  }

  // Câmera que segue o jogador
  let camera = {x: 0, y: 0};

  function updateCamera() {
    camera.x = player.x - canvas.width/2;
    camera.y = player.y - canvas.height/2;

    if(camera.x < 0) camera.x = 0;
    if(camera.y < 0) camera.y = 0;
    if(camera.x > map.width - canvas.width) camera.x = map.width - canvas.width;
    if(camera.y > map.height - canvas.height) camera.y = map.height - canvas.height;
  }

  // Jogo loop principal
  function gameLoop() {
    updatePlayer();
    updateCamera();

    drawMap();
    drawPlayer();

    requestAnimationFrame(gameLoop);
  }

  // Definir dimensões do jogador
  classes.forEach(cl => {
    cl.width = 30;
    cl.height = 30;
  });
</script>

</body>
</html>